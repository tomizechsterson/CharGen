version: 0.1.{build}

branches:
  only:
    - master
    
image: Visual Studio 2017

clone_folder: c:\projects\CharGen

matrix:
  fast_finish: true
  
build:
  parallel: true
  project: CharGen.sln
  publish_wap_xcopy: true
  verbosity: minimal

before_build:
  - cmd: dotnet restore
  
test:
  assemblies:
    only:
      - CharGen.UnitTests.dll
      
after_test:
- cmd: dotnet publish ADD2CharacterService -c Release -o ./publish
      
artifacts:
- path: ADD2CharacterService/publish
  name: publish
      
deploy:
- provider: AzureAppServiceZipDeploy
  appservice_environment: false
  website: chargendev
  username: $chargendev
  password:
    secure: aYrX7hXvsTgU9Eri9HLRDMpvnUI6AjD0kR/Z5losoiDS8ddYGfRR15R+pThX5EaymRAUIC9Xm2uC72NI9VcFqA==
  artifact: publish